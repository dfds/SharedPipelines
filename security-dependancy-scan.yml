parameters:
- name: sourceDirectory
  type: string
  default: '$(Build.SourcesDirectory)'

steps:
- task: OWASPDependencyCheck@0
  inputs:
    outputDirectory: '$(Agent.TempDirectory)/dependency-scan-results'
    scanDirectory: '${{ parameters.sourcesDirectory }}'
    outputFormat: 'ALL'
    useSonarQubeIntegration: false

- task: CopyFiles@2
  inputs:
    SourceFolder: '$(Agent.TempDirectory)/dependency-scan-results'
    contents: "*.sarif" 
    targetFolder: $(Agent.TempDirectory)/sast-results/dependency-scan-results/

- task: DeleteFiles@1
  displayName: 'Remove unneeded files'
  inputs:
    SourceFolder: '$(Agent.TempDirectory)'
    contents: "$(Agent.TempDirectory)/*.sarif" 